
---

### 📝 题目：[36] 有效的数独 —— 关键突破点  

**核心卡点**：  
能想到用 `row_has[i][num]` 和 `col_has[j][num]` 分别校验行与列的重复，但**始终无法清晰建模“3×3 宫格”的归属逻辑**。曾尝试通过复杂条件（如 `i<3 && j<3` 等）手动划分区域，导致代码冗长且难以扩展。

**关键顿悟**：  
✅ **利用整数除法自动聚类**：  
- 对于任意位置 `(i, j)`，其所属的 3×3 宫格在逻辑上可唯一标识为 `(i/3, j/3)`（C++ 中整数除法自动向下取整）。  
- 例如：  
  - `(0,0) → (0,0)`，`(2,2) → (0,0)`  
  - `(3,5) → (1,1)`，`(8,8) → (2,2)`  
- 因此只需一个 `sub_box_has[3][3][9]` 数组，即可为每个宫格独立维护数字出现状态。

**实现精髓**：  
- 三重校验并行：行、列、宫格互不干扰，共享同一遍历过程；  
- 跳过 `'.'`，仅处理有效数字；  
- 使用 `b - '1'` 将字符 `'1'~'9'` 映射为索引 `0~8`，节省空间且避免哈希开销；  
- 一旦发现任一维度重复，立即返回 `false`，高效剪枝。

**经验提炼**：  
> **“分块问题”常可通过坐标缩放（如 `/3`、`/k`）转化为低维索引**。  
> 不必硬写边界条件，善用整除的“自然分组”特性，是处理网格类问题的重要技巧。

---
